<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="author" content="Jamsa" />
        <meta name="robots" content="index, follow"/>

        <meta property="og:title" content="JTV开发笔记1-开始"/>
        <meta property="og:url" content="./jtvkai-fa-bi-ji-1-kai-shi.html"/>
        <meta property="og:site_name" content="Jamsa的笔记"/>
        <meta property="og:type" content="article"/>

        <link rel="canonical" href="./jtvkai-fa-bi-ji-1-kai-shi.html" />

        <title>JTV开发笔记1-开始 | Jamsa的笔记</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" />
        <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" />
        

        <link rel="stylesheet" type="text/css" href="./theme/css/main.css" />

        <script type="text/javascript">var switchTo5x=true;</script>
        <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
        <script type="text/javascript">
         stLight.options({
             publisher: "",
             doNotHash: false,
             doNotCopy: false,
             hashAddressBar: false
         });
        </script>
    </head>

    <body id="index">
        <div class="row-fluid">
            <div class="span10 offset1">
                <header id="banner" >
                    <h1>
                        <a href="./">Jamsa的笔记 </a>
                    </h1>
                    <nav class="navbar">
                        <div class="navbar-inner">
                            <ul class="nav">
                                <li ><a href="./category/da-shu-ju.html">大数据</a></li>
                                <li ><a href="./category/fang-fa.html">方法</a></li>
                                <li ><a href="./category/ji-qi-xue-xi.html">机器学习</a></li>
                                <li class="active"><a href="./category/kai-fa.html">开发</a></li>
                                <li ><a href="./category/qian-duan.html">前端</a></li>
                                <li ><a href="./category/xiao-lu.html">效率</a></li>
                                <li ><a href="./category/yi-dong.html">移动</a></li>
                            </ul>

                        </div>
                    </nav>
                </header><!-- /#banner -->
            </div>
        </div>

        <div class="row-fluid">
            <div class="span10 offset1">
                <div class="row-fluid">
<div class="span10 offset1">
  <section>
    <article>
      <header>
        <h1 class="entry-title">
          <a href="./jtvkai-fa-bi-ji-1-kai-shi.html" rel="bookmark"
             title="Permalink to JTV开发笔记1-开始">JTV开发笔记1-开始</a></h1>
      </header>
      <div class="entry-content">
<footer class="post-info">
    <address class="vcard author">
        by <a class="url fn" href="./author/jamsa.html">Jamsa</a>
    </address>

    in <a href="./category/kai-fa.html">开发</a>

    on 2018-07-17

        |
        tags:         <a href="./tag/scala.html">scala</a>
        <a href="./tag/netty.html">netty</a>
        <a href="./tag/jtv.html">jtv</a>


        |
        <a href="./jtvkai-fa-bi-ji-1-kai-shi.html#disqus_thread">comments</a>

    
</footer><!-- /.post-info -->

        <p>本文是<a href="https://github.com/Jamsa/jtv">Jtv</a>的开发笔记。Jtv是一个远程桌面工具。</p>
<h1>起因</h1>
<p>因为工作原因，我经常需要进行远程桌面操作。尝试过多种不同的远程桌面方案，如：QQ远程、Teamviewer、Windows远程桌面、Hamachi等等。在速度比较稳定的，且支持内网连接的工具里只有Teamviewer和QQ远程能稳定使用。切换至Mac环境后，Teamviewer就成了唯一选择，Teamviewer被判定为商业使用后，每5分钟会中断一次，无法正常使用。之间也尝试过使用ngrok配合其它内网vnc工具来进行远程连接。但这些方式都不太方便，比如使用ngrok + Windows远程桌面也能连接，但是远程桌面和VNC都无法与远程用户共享桌面。</p>
<p>由于这些原因，就有了自己开发一个简化版远程桌面工具的想法。</p>
<h1>目标</h1>
<p>仅把它当作个业余项目，近期目标是实现：以中心服务器进行交换，支持内网连接的远程桌面和控制功能。</p>
<h1>技术选型</h1>
<p>个人项目选型上比较自由，主要考虑以下几个方面：</p>
<ul>
<li>
<p>考虑到跨平台使用，选定在Java平台上。</p>
</li>
<li>
<p>利用Swing的Robot类可实现对键盘、鼠标的控制。</p>
</li>
<li>
<p>Java语言写Swing相关的内容太啰嗦，选Scala了。</p>
</li>
<li>
<p>网络通讯模块选择netty。</p>
</li>
</ul>
<p>选择的版本如下：</p>
<ul>
<li>
<p>scala 2.12.6</p>
</li>
<li>
<p>sbt 1.1.6</p>
</li>
<li>
<p>netty 4.1.25.Final</p>
</li>
</ul>
<h1>工程创建</h1>
<p>使用<code>sbt</code>来创建工程，工程代号<code>jtv</code>。</p>
<ol>
<li>创建工程目录结构</li>
</ol>
<div class="highlight"><pre><span></span>➜  jtv git:(master) ✗ tree -L 2
.
├── README.md
├── build.sbt
├── client
│&nbsp;&nbsp; ├── src
├── common
│&nbsp;&nbsp; ├── src
├── project
│&nbsp;&nbsp; ├── Dependencies.scala
│&nbsp;&nbsp; ├── build.properties
│&nbsp;&nbsp; ├── plugins.sbt
├── server
│&nbsp;&nbsp; ├── src
</pre></div>
<ol>
<li>
<p>在<code>project/build.properties</code>中添加<code>sbt.version=1.1.6</code>定义sbt版本。</p>
</li>
<li>
<p>在<code>project/plugin.sbt</code>中引用打包插件<code>addSbtPlugin("com.typesafe.sbt" % "sbt-native-packager" % "1.3.5")</code></p>
</li>
<li>
<p>将依赖集中定义在<code>project/Dependencies.scala</code>中，内容如下：</p>
</li>
</ol>
<div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">sbt._</span>

<span class="k">object</span> <span class="nc">Dependencies</span> <span class="o">{</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="n">scalaTest</span> <span class="k">=</span> <span class="s">"org.scalatest"</span> <span class="o">%%</span> <span class="s">"scalatest"</span> <span class="o">%</span> <span class="s">"3.0.3"</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="n">netty</span> <span class="k">=</span> <span class="s">"io.netty"</span> <span class="o">%</span> <span class="s">"netty-all"</span> <span class="o">%</span> <span class="s">"4.1.25.Final"</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="n">logging</span> <span class="k">=</span> <span class="s">"com.typesafe.scala-logging"</span> <span class="o">%%</span> <span class="s">"scala-logging"</span> <span class="o">%</span> <span class="s">"3.9.0"</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="n">logback</span> <span class="k">=</span>  <span class="s">"ch.qos.logback"</span> <span class="o">%</span> <span class="s">"logback-classic"</span> <span class="o">%</span> <span class="s">"1.2.3"</span>
<span class="o">}</span>
</pre></div>
<p>使用了<code>scala-logging</code>日志模块。</p>
<ol>
<li>在<code>build.sbt</code>中定义各个模块：</li>
</ol>
<div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">Dependencies._</span>

<span class="k">lazy</span> <span class="k">val</span> <span class="n">commonSettings</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="n">organization</span> <span class="o">:=</span> <span class="s">"com.github.jamsa.jtv"</span><span class="o">,</span>
  <span class="n">version</span> <span class="o">:=</span> <span class="s">"0.1.0"</span><span class="o">,</span>
  <span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">"2.12.6"</span><span class="o">,</span>
  <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="n">scalaTest</span> <span class="o">%</span> <span class="nc">Test</span><span class="o">,</span>
  <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="n">netty</span><span class="o">,</span>
  <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="n">logging</span><span class="o">,</span>
  <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="n">logback</span>
<span class="o">)</span>

<span class="k">lazy</span> <span class="k">val</span> <span class="n">common</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="n">file</span><span class="o">(</span><span class="s">"common"</span><span class="o">))</span>
  <span class="o">.</span><span class="n">settings</span><span class="o">(</span>
    <span class="n">commonSettings</span><span class="o">,</span>
    <span class="n">name</span> <span class="o">:=</span> <span class="s">"jtv-common"</span>
  <span class="o">)</span>

<span class="k">lazy</span> <span class="k">val</span> <span class="n">client</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="n">file</span><span class="o">(</span><span class="s">"client"</span><span class="o">)).</span><span class="n">dependsOn</span><span class="o">(</span><span class="n">common</span><span class="o">)</span>
  <span class="o">.</span><span class="n">settings</span><span class="o">(</span>
    <span class="n">commonSettings</span><span class="o">,</span>
    <span class="n">name</span> <span class="o">:=</span> <span class="s">"jtv-client"</span><span class="o">,</span>
    <span class="n">mainClass</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">:=</span> <span class="nc">Some</span><span class="o">(</span><span class="s">"com.github.jamsa.jtv.client.manager.JtvClientManager"</span><span class="o">)</span>
  <span class="o">).</span><span class="n">enablePlugins</span><span class="o">(</span><span class="nc">JavaAppPackaging</span><span class="o">)</span>

<span class="k">lazy</span> <span class="k">val</span> <span class="n">server</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="n">file</span><span class="o">(</span><span class="s">"server"</span><span class="o">)).</span><span class="n">dependsOn</span><span class="o">(</span><span class="n">common</span><span class="o">)</span>
  <span class="o">.</span><span class="n">settings</span><span class="o">(</span>
    <span class="n">commonSettings</span><span class="o">,</span>
    <span class="n">name</span> <span class="o">:=</span> <span class="s">"jtv-server"</span><span class="o">,</span>
    <span class="n">mainClass</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">:=</span> <span class="nc">Some</span><span class="o">(</span><span class="s">"com.github.jamsa.jtv.server.JtvMain"</span><span class="o">)</span>
  <span class="o">).</span><span class="n">enablePlugins</span><span class="o">(</span><span class="nc">JavaAppPackaging</span><span class="o">)</span>


<span class="k">lazy</span> <span class="k">val</span> <span class="n">root</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="n">file</span><span class="o">(</span><span class="s">"."</span><span class="o">)).</span><span class="n">aggregate</span><span class="o">(</span><span class="n">common</span><span class="o">,</span> <span class="n">client</span><span class="o">,</span> <span class="n">server</span><span class="o">)</span>
  <span class="o">.</span><span class="n">settings</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">:=</span> <span class="s">"jtv"</span>
  <span class="o">)</span>
</pre></div>
<p><code>commonSettings</code>为各模块的共享定义。<code>common</code>模块为公共依赖模块，主要存放通讯协议、网络层相关的公用类和工具类。<code>client</code>模块为安装在最终客户机器上的客户端程序。<code>server</code>模块为处理数据交换的服务程序。</p>
<p>在<code>client</code>和<code>server</code>上启用<code>JavaAppPackaging</code>插件，以便输出最终的发布包。</p>

      </div><!-- /.entry-content -->
      <div class="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_identifier = "jtvkai-fa-bi-ji-1-kai-shi.html";
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//jamsa-github-io.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      </div>

    </article>
  </section>
</div>
                </div>
            </div>
        </div>

        <footer id="site-footer">
            <div class="row-fluid">
                <div class="span10 offset1">
                    <address>
                        <p>
                        This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                        </p>
                        <p>
                            <a href="http://github.com/jsliang/pelican-fresh/">Fresh</a> is a responsive theme designed by <a href="http://jsliang.com/">jsliang</a> and <a href="https://github.com/jsliang/pelican-fresh/graphs/contributors">contributors</a>.
                        Special thanks to <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a> and <a href="http://getbootstrap.com/">Twitter Bootstrap</a>.
                        </p>
                    </address>
                </div>
            </div>
        </footer>

<script type="text/javascript">
    var disqus_shortname = 'jamsa-github-io';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
        <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

        <link href="http://apps.bdimg.com/libs/highlight.js/9.1.0/styles/default.min.css" rel="stylesheet">
        <script src="http://apps.bdimg.com/libs/highlight.js/9.1.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
         var _hmt = _hmt || [];
         (function() {
           var hm = document.createElement("script");
           hm.src = "https://hm.baidu.com/hm.js?5e20e9cdd1185d24ece1dae11118a04f";
           var s = document.getElementsByTagName("script")[0]; 
           s.parentNode.insertBefore(hm, s);
         })();
        </script>
</body>
</html>